{"version":3,"sources":["index.js"],"names":["inizializza","iframe","$","version","urlid","client","caricaModello","on","hasClass","removeClass","cliccato","Sketchfab","init","success","api","load","start","addEventListener","stop","setFov","lookat","target","listaCamera","eye","cameraAttuale","loop","setTimeout","getScreenShot","err","result","height","width","window","open","this","html","css","addClass","e","frameX","position","left","frameY","top","x","pageX","y","pageY","z","distanza","Math","sqrt","pow","getNodeMap","nodes","console","log","empty","each","i","val","append","name","instanceID","hide","show","grafo","getSceneGraph","getTextureList","textures","uid","url","id","attr","updateTexture","textureUid","getMaterialList","materials","stateSetID","materiale","channels","Opacity","enable","factor","setMaterial","getPostProcessing","settings","setPostProcessing","sharpenEnable","rgbmDefault","rgbmBloom","grainEnable","chromaticAberrationEnable","error","callback","annotation","annotation_cycle","annotations_visible","autospin","autostart","camera","fps_speed","preload","scrollwheel","ui_stop","document","ready"],"mappings":"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","file":"main.js","sourcesContent":["'use strict';\n\n$(document).ready(() => {\n  inizializza();\n});\n\n/**\n * Funzione gestione inizializzazione\n */\nfunction inizializza() {\n  // Dichiarazione variabili\n  const iframe = $('#api-frame')[0];\n  const version = '1.0.0';\n  const urlid = '9c1e7cfb2f734c3fa0425379578bcef3';\n  let client = null;\n\n  caricaModello(iframe, version, urlid, client);\n\n  $('.carica').on('click tap', () => {\n    caricaModello(iframe, version, urlid, client);\n\n    if ($('.player__lettore').hasClass('player__lettore--invisibile')) {\n      $('.player__lettore').removeClass('player__lettore--invisibile');\n    }\n  });\n}\n\n/**\n * Funzione gestione inizializzazione API\n * @param {object} iframe Nodo DOM del lettore\n * @param {string} version Versione APP\n * @param {string} urlid ID Modello\n * @param {object} client Lettore modello\n */\nfunction caricaModello(iframe, version, urlid, client) {\n  let cliccato = false;\n\n  client = new Sketchfab(version, iframe);\n\n  client.init(urlid, {\n    success: function onSuccess(api) {\n      api.load();\n      api.start();\n      api.addEventListener('viewerready', () => {\n        $('.player__lettore').removeClass('player__lettore--invisibile');\n        $('.play').on('click tap', () => {\n          api.start();\n        });\n        $('.stop').on('click tap', () => {\n          api.stop();\n        });\n        $('.fov').on('click tap', () => {\n          api.setFov(60);\n        });\n        $('.prospettiva').on('click tap', () => {\n          api.lookat(\n            [10, 13, 10], // eye position\n            [10, 10, 10],   // target to lookat\n            5.5          // duration of the animation in seconds\n          );\n        });\n        // Animazione\n        $('.panoramica').on('click tap', () => {\n          let target = [0.0, 0.0, 1.0];\n          let listaCamera = [{\n              eye: [2, 0, 0],\n          }, {\n              eye: [1, 1, 0],\n          }, {\n              eye: [0, 2, 0],\n          }, {\n              eye: [-1, 1, 0],\n          }, {\n              eye: [-2, 0, 0],\n          }, {\n              eye: [-1, -1, 0],\n          }, {\n              eye: [0, -2, 0],\n          }, {\n              eye: [1, -1, 0],\n          }];\n          let cameraAttuale = 5;\n          let loop = () => {\n            cameraAttuale++;\n              api.lookat(listaCamera[cameraAttuale % 8].eye, target, 4);\n\n              setTimeout(loop, 5000);\n          };\n\n          api.start(loop);\n        });\n        $('.screenshot').on('click tap', () => {\n          api.getScreenShot( 'image/png', (err, result) => {\n            let height = $('#api-frame').height();\n            let width = $('#api-frame').width();\n\n            if (height < 100) {\n                height = 100;\n            }\n            if (width > 100) {\n                width = 100;\n            }\n\n            $(window)[0].open(result, '_blank', 'height = '+\n            height + ', width = ' + width);\n          });\n        });\n        // Navigazione Libera\n        $('.navigazione').on('click tap', function() {\n          if (!cliccato) {\n            $('.player::before').css('visibility', 'visible');\n            $('.player').addClass('libera');\n            $(this).html('Navigazione libera (attiva)');\n\n            cliccato = true;\n          } else {\n            $(this).html('Navigazione libera');\n            $('.player').removeClass('libera');\n            $('.player::before').css('visibility', 'hidden');\n\n            cliccato = false;\n          }\n        });\n        $('body').on('mousemove', function(e) {\n          if ($('.player').hasClass('libera')) {\n            // Calculate the location of the middle of the frame (Where we want the model to stay)\n            let frameX = $('#api-frame').position().left + $('#api-frame').width() / 2;\n            let frameY = $( '#api-frame' ).position().top + $('#api-frame').height() / 2;\n            let x = e.pageX - frameX;\n            let y = e.pageY - frameY;\n            let z = 2;\n            // Calculate the distance, normalize the vector by dividing by distance and multiplying by a factor\n            let distanza = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2) + Math.pow(z, 2));\n            x = (x / distanza) * 6;\n            y = (y / distanza) * 6;\n            z = (z / distanza) * 6;\n\n            // x, y and z depend on how the model was made\n            api.lookat([y, -x, z], [0, 0, 0], 0);\n          }\n        });\n        // Oggetti\n        $('.oggetti').on('click tap', () => {\n            api.getNodeMap((err, nodes) => {\n              if (!err) {\n                console.log(nodes);\n\n                $('.output').empty();\n                $.each(nodes, (i, val) => {\n                  $('.output')\n                  .append(val.name + ' | ID: ' +\n                  val.instanceID +'<br />');\n                });\n              }\n            });\n        });\n        $('.nascosto').on('click tap', () => {\n          api.hide('76');\n        });\n        $('.mostra').on('click tap', () => {\n          api.show('76');\n        });\n        // Grafo\n        $('.grafo').on('click tap', () => {\n          let grafo = api.getSceneGraph();\n          \n          console.log(grafo);\n\n          $('.output').empty();\n          $('.output').append(grafo);\n\n        });\n        // Texture\n        $('.texture').on('click tap', () => {\n          api.getTextureList((err, textures) => {\n            if (!err) {\n              console.log(textures);\n\n              $('.output').empty();\n              $.each(textures, (i, val) => {\n                $('.output')\n                .append(val.name + ' | UID: ' +\n                val.uid +'<br />');\n              });\n            }\n          });\n        });\n        $('.texture-cambia').on('click tap', function() {\n          let url = null;\n          let id = null;\n\n          switch($(this).attr('data-text')) {\n            case 'marmo': \n              url = 'https://media.sketchfab.com/urls/9c1e7cfb2f734c3fa0425379578bcef3/dist/textures/7853c7fb6e3e4a01a406012949b26070/fccbc92f7d4844508b0d10f0984734d4.jpg';\n              id = '7853c7fb6e3e4a01a406012949b26070';\n              \n              break;\n            case 'chiaro':\n              url = 'https://media.sketchfab.com/urls/9c1e7cfb2f734c3fa0425379578bcef3/dist/textures/c511c36f5e4f4279bed11cf319cfc719/24b29ac0ffe444b581127af2efb8fb4a.png';\n              id = '7853c7fb6e3e4a01a406012949b26070';\n\n              break;\n            case 'scuro':\n              url = 'https://media.sketchfab.com/urls/9c1e7cfb2f734c3fa0425379578bcef3/dist/textures/7853c7fb6e3e4a01a406012949b26070/fccbc92f7d4844508b0d10f0984734d4.jpg';\n              id = 'c511c36f5e4f4279bed11cf319cfc719';\n              \n              break;\n            case 'oro':\n              url = 'https://media.sketchfab.com/urls/9c1e7cfb2f734c3fa0425379578bcef3/dist/textures/c511c36f5e4f4279bed11cf319cfc719/24b29ac0ffe444b581127af2efb8fb4a.png';\n              id = 'c511c36f5e4f4279bed11cf319cfc719';\n\n              break;\n            default:\n              break;\n          }\n\n          api.updateTexture(url, id, (err, textureUid) => {\n              if (!err) {\n                console.log(textureUid, url, id);\n\n                $('.output').empty();\n                $('.output').append('Texture aggiornata con uid: '+ textureUid);\n              }\n            }\n          );\n        });\n        // Materiali\n        $('.materiali').on('click tap', () => {\n          api.getMaterialList((err, materials) => {\n            if (!err) {\n              console.log(materials);\n\n              $('.output').empty();\n              $.each(materials, (i, val) => {\n                $('.output')\n                .append(val.name + ' | stateSetID: ' +\n                val.stateSetID +'<br />');\n              });\n            }\n          });\n        });\n        $('.aggiorna').on('click tap', () => {\n          api.getMaterialList((err, materials) => {\n            // Turn off the diffuse on the first material\n            let materiale = materials[0];\n\n            materiale.channels.Opacity.enable = true;\n            materiale.channels.Opacity.factor = 0;\n\n            console.log(materiale);\n\n            // Apply the change\n            api.setMaterial(materiale, () => {\n              $('.output').empty();\n              $('.output').append('Opacità azzerata su '+ materiale.name);\n            });\n          });\n        });\n        $('.reset').on('click tap', () => {\n          api.getMaterialList((err, materials) => {\n            // Turn off the diffuse on the first material\n            let materiale = materials[0];\n\n            materiale.channels.Opacity.enable = false;\n            materiale.channels.Opacity.factor = 1;\n\n            console.log(materiale);\n                      \n            api.setMaterial(materiale, () => {\n              $('.output').empty();\n              $('.output').append('Valori di default su '+ materiale.name);\n            });\n          });\n        });\n        // Post Processing\n        $('.filtri').on('click tap', () => {\n          api.getPostProcessing((settings) => {\n              console.log(settings);\n\n              $('.output').empty();\n              $.each(settings, (i, val) => {\n                $('.output').append(i + ' | ' + val +'<br />');\n              });\n          });\n        });\n        $('.modifica').on('click tap', () => {\n          api.setPostProcessing({\n            sharpenEnable: false,\n            rgbmDefault: 3,\n            rgbmBloom: 2,\n            grainEnable: true,\n            chromaticAberrationEnable: true,\n          });\n          $('.output').empty();\n          $('.output')\n          .append('sharpenEnable disattivato<br />rgbmDefault: 3<br />rgbmBloom: 2<br />grainEnable: true<br />chromaticAberrationEnable: true');\n        });\n      });\n    },\n    error: function onError(callback) {\n        $('aside').append(callback);\n    },\n    annotation: 1,\n    annotation_cycle: 0,\n    annotations_visible: 1,\n    autospin: 0,\n    autostart: 1,\n    camera: 1,\n    fps_speed: 60,\n    preload: 1,\n    scrollwheel: 1,\n    ui_stop: 0,\n    /**\n     * Solo PRO:\n     * transparent: 0, <- Sfondo\n     * Solo BIZ:\n     * ui_controls: 0, <- Toolbar (basso)\n     * ui_general_controls: 0, <- Toolbar (destra)\n     * ui_settings: 0,\n     * ui_help: 0,\n     * ui_hint: 0,\n     * ui_fullscreen: 0,\n     * ui_animations: 0, <- Menu\n     * ui_annotations: 0, <- Menu\n     * ui_infos: 0,\n     */\n  });\n}\n"]}